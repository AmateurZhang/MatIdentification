<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2019a"><title>Code of Topology Identification and Line Parameter</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.7999992370605px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: center;  }
.S1 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 28.7999992370605px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: center;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: center;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S5 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px; overflow-x: hidden; line-height: 17.2339992523193px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}
.S6 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S7 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: bold; text-align: left;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S12 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: bold; text-align: left;  }
.S13 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S14 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.2339992523193px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 14px;  }
.S15 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: bold; text-align: left;  }
.S16 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Code of Topology Identification and Line Parameter</span></h1><h1  class = 'S1'><span>Estimation for non-PMU Distribution Network:</span></h1><h1  class = 'S1'><span>A Numerical Method</span></h1><div  class = 'S2'><span>Jiawei Zhang, Student Member, IEEE, Yi Wang, Member, IEEE, Yang Weng, Member, IEEE, and Ning Zhang, Senior Member, IEEE</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>clear;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[Identification] Pragramme starts .........\n'</span><span>)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="E6CF37E0" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_0" style="max-height: 261px; width: 1014px;"><div class="textElement">[Identification] Pragramme starts .........</div></div></div></div></div><h2  class = 'S6'><span>Data processing</span></h2><h3  class = 'S7'><span>Import data</span></h3><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[Identification] Data processing .........\n'</span><span>)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="8FDFB308" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_1" style="max-height: 261px; width: 1014px;"><div class="textElement">[Identification] Data processing .........</div></div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre;"><span>pf = loadcase(</span><span style="color: rgb(160, 32, 240);">'case33bw'</span><span>);                </span><span style="color: rgb(34, 139, 34);">% test case</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>load = readLD;                                  </span><span style="color: rgb(34, 139, 34);">% power load origin file</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>freq = 1/10;                                    </span><span style="color: rgb(34, 139, 34);">% times per hour</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>err  = 0.001;                                   </span><span style="color: rgb(34, 139, 34);">% additional error</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>tol = 10^-8;                                    </span><span style="color: rgb(34, 139, 34);">% tol for ac flow calculation</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>qlist = data_processing(pf,load,freq,err,tol);  </span><span style="color: rgb(34, 139, 34);">% build datasets</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="F7F7AF29" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="73" data-hashorizontaloverflow="false" data-testid="output_2" style="max-height: 261px; width: 1014px;"><div class="textElement">[data processing] Build No. 50 dataset
[data processing] Build No. 100 dataset
[data processing] Build No. 150 dataset
[data processing] Build No. 200 dataset
[data processing] Build No. 240 dataset</div></div></div></div></div><h2  class = 'S6'><span>Basic identification</span></h2><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[Identification] Basic identification .........\n'</span><span>)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="B96164B1" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_3" style="max-height: 261px; width: 1014px;"><div class="textElement">[Identification] Basic identification .........</div></div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre;"><span>pect = 0.02;                                    </span><span style="color: rgb(34, 139, 34);">% gammar: remove branch thro</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>thro = 10^-8;                                   </span><span style="color: rgb(34, 139, 34);">% decide stop basic identification</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>[mpfn,flag] = basicidentify(qlist,pect,thro);   </span><span style="color: rgb(34, 139, 34);">% basic identification</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="3D84E908" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="241" data-hashorizontaloverflow="false" data-testid="output_4" style="max-height: 261px; width: 1014px;"><div class="textElement">[Basic Identification] No.1 ends with error 199.136773
 Wrong branch +/-: 192,0
[Basic Identification] No.2 ends with error 85.058044
 Wrong branch +/-: 43,0
[Basic Identification] No.3 ends with error 19.823915
 Wrong branch +/-: 14,0
[Basic Identification] No.4 ends with error 8.336062
 Wrong branch +/-: 10,0
[Basic Identification] No.5 ends with error 2.329934
 Wrong branch +/-: 8,0
[Basic Identification] No.6 ends with error 2.361255
 Wrong branch +/-: 6,0
[Basic Identification] No.7 ends with error 2.233993
 Wrong branch +/-: 6,0
[Basic Identification] Converged after 8 iterations with error 0.000000e+00
 Wrong branch +/-: 6,0
时间已过 0.064540 秒。</div></div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre;"><span>                                                </span><span style="color: rgb(34, 139, 34);">% flag == 0: wrong topo</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>                                                </span><span style="color: rgb(34, 139, 34);">% detected</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">if </span><span>flag == 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    fprintf(</span><span style="color: rgb(160, 32, 240);">'[Basic identification] Wrong topology detected. REDUCE PECT!\n We terminate the programme to save time\n'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    quit();</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>tic;</span></span></div></div></div><h2  class = 'S6'><span>Fine identification</span></h2><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[Identification] Fine identification .........\n'</span><span>)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="8F61AFD8" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_5" style="max-height: 261px; width: 1014px;"><div class="textElement">[Identification] Fine identification .........</div></div></div></div></div><h3  class = 'S7'><span>Select last 30 data</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mpfn.q = mpfn.q(:,end-29:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>mpfn.smat = mpfn.smat(:,end-29:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>mpfn.dsmat = zeros(size(mpfn.smat));</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>mpfn.vmat = mpfn.vmat(:,end-29:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>mpfn.thetamat = mpfn.thetamat(:,end-29:end);</span></span></div></div></div><h3  class = 'S12'><span>Fine identification SETTINGS</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>MAXITER = 25;             </span><span style="color: rgb(34, 139, 34);">% maximum iteration time</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>varsigma = 0.01;          </span><span style="color: rgb(34, 139, 34);">% decide whether to remove branches</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>xi = 0.05;                </span><span style="color: rgb(34, 139, 34);">% threshold to remove branches</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>varphi = 1*10^-10;        </span><span style="color: rgb(34, 139, 34);">% decide whether to end iterations</span></span></div></div></div><h3  class = 'S12'><span>Constants</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>[n,~] = size(mpfn.bus);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>[m,~] = size(mpfn.branch);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>[~,M] = size(mpfn.smat);</span></span></div></div></div><h3  class = 'S12'><span>Initialization</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>deltapqlist = deltaPQ(mpfn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>dftp = norm(deltapqlist,2);   </span><span style="color: rgb(34, 139, 34);">% throshold</span></span></div></div></div><h3  class = 'S12'><span>Error evaluation when starts</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>[gberror,wrong_add,wrong_miss] = errorevaluate(mpfn,qlist(1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>gberror = gberror*100;  </span><span style="color: rgb(34, 139, 34);">% display in 100%</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[fine identification] Starts with error %e\n'</span><span>,dftp);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="125D6F2C" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_6" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] Starts with error 8.482319e-02</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S13'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n'</span><span>,gberror(1),gberror(2),length(wrong_add),length(wrong_miss));</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="E5BD5588" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_7" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 35.028203%, b: 41.714352%; Wrong branch +/-: 6,0</div></div></div></div></div><h3  class = 'S12'><span>Start iteration</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">for </span><span>T = 1:MAXITER</span></span></div></div></div><h4  class = 'S15'><span>Pseudo-Power Flow Calculation</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre;"><span>    mpfn = pseudopf(mpfn);</span></span></div></div></div><h4  class = 'S15'><span>Jacobian matrix</span></h4><div  class = 'S16'><span style=' font-family: monospace;'>| A B C |</span></div><div  class = 'S16'><span style=' font-family: monospace;'>| D E F |</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre;"><span>    Jmat = Jacobianmat(mpfn);</span></span></div></div></div><h4  class = 'S15'><span>Generalized reverse</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    invJmat = pinv(Jmat);   </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    </span><span style="color: rgb(34, 139, 34);">% Delta S = Delta P,Q</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    deltapqlist = deltaPQ(mpfn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    </span><span style="color: rgb(34, 139, 34);">% delta g,b,theta</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    deltagbt = invJmat*deltapqlist;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    </span><span style="color: rgb(34, 139, 34);">% renew g,b and theta</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>    mpfn = renewgbt(mpfn,deltagbt);</span></span></div></div></div><h4  class = 'S15'><span>Calculate throshold</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    deltapqlist = deltaPQ(mpfn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>    df = norm(deltapqlist,2);   </span><span style="color: rgb(34, 139, 34);">% throshold</span></span></div></div></div><h4  class = 'S15'><span>remove wrong branches</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>abs(df - dftp)&lt;varsigma</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        mpfn = removebran(mpfn,xi);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h4  class = 'S15'><span>calculate throshold</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    deltapqlist = deltaPQ(mpfn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>    df = norm(deltapqlist,2);   </span><span style="color: rgb(34, 139, 34);">% throshold</span></span></div></div></div><h4  class = 'S15'><span>Error evaluation</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    [gberror,wrong_add,wrong_miss] = errorevaluate(mpfn,qlist(1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>    gberror = gberror*100;  </span><span style="color: rgb(34, 139, 34);">% display in 100%</span></span></div></div></div><h4  class = 'S15'><span>Decide whether to end iteration</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>abs(df - dftp)&lt;varphi &amp;&amp; T~=1</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'[fine identification] Ends with %d iterations, with error %e\n'</span><span>,T,df);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n'</span><span>,gberror(1),gberror(2),length(wrong_add),length(wrong_miss));</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">break</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'[fine identification] No.%d ends with error %e\n'</span><span>,T,df);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n'</span><span>,gberror(1),gberror(2),length(wrong_add),length(wrong_miss));</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="E36A7493" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_8" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.1 ends with error 1.846560e-01</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="B3509362" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_9" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 20.058325%, b: 16.032614%; Wrong branch +/-: 6,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="C0A521B1" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_10" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.2 ends with error 3.951914e-02</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="4CC85A06" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_11" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.776318%, b: 2.068346%; Wrong branch +/-: 6,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="EF26D769" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_12" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.3 ends with error 8.341512e-03</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="DB4ED759" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_13" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.220732%, b: 0.418977%; Wrong branch +/-: 6,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="3C62E453" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_14" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.4 ends with error 2.228952e-03</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="A9CDAFEE" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_15" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.305660%, b: 0.240022%; Wrong branch +/-: 0,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="0A56DE69" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_16" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.5 ends with error 4.800817e-05</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="EE58EEEE" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_17" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.113633%, b: 0.156629%; Wrong branch +/-: 0,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="F1FDBD07" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_18" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] No.6 ends with error 4.347213e-05</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="90C7322C" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_19" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.113615%, b: 0.156165%; Wrong branch +/-: 0,0</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="963BBE96" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_20" style="max-height: 261px; width: 1014px;"><div class="textElement">[fine identification] Ends with 7 iterations, with error 4.347213e-05</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="B2FB68CC" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_21" style="max-height: 261px; width: 1014px;"><div class="textElement">MAPE: g: 0.113614%, b: 0.156166%; Wrong branch +/-: 0,0</div></div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre;"><span>    dftp = df;  </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>toc;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'[Identification] Pragramme successfully ends .........\n'</span><span>)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="A82D239A" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_22" style="max-height: 261px; width: 1014px;"><div class="textElement">时间已过 41.840540 秒。</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="1B8A9667" data-scroll-top="null" data-scroll-left="null" data-width="984" data-height="18" data-hashorizontaloverflow="false" data-testid="output_23" style="max-height: 261px; width: 1014px;"><div class="textElement">[Identification] Pragramme successfully ends .........</div></div></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Code of Topology Identification and Line Parameter
%% Estimation for non-PMU Distribution Network:
%% A Numerical Method
% Jiawei Zhang, Student Member, IEEE, Yi Wang, Member, IEEE, Yang Weng, Member, 
% IEEE, and Ning Zhang, Senior Member, IEEE

clear;
fprintf('[Identification] Pragramme starts .........\n')
%% Data processing
% Import data

fprintf('[Identification] Data processing .........\n')
pf = loadcase('case33bw');                % test case
load = readLD;                                  % power load origin file
freq = 1/10;                                    % times per hour
err  = 0.001;                                   % additional error
tol = 10^-8;                                    % tol for ac flow calculation
qlist = data_processing(pf,load,freq,err,tol);  % build datasets
%% Basic identification

fprintf('[Identification] Basic identification .........\n')
pect = 0.02;                                    % gammar: remove branch thro
thro = 10^-8;                                   % decide stop basic identification
[mpfn,flag] = basicidentify(qlist,pect,thro);   % basic identification
                                                % flag == 0: wrong topo
                                                % detected
if flag == 0
    fprintf('[Basic identification] Wrong topology detected. REDUCE PECT!\n We terminate the programme to save time\n')
    quit();
end
tic;
%% Fine identification

fprintf('[Identification] Fine identification .........\n')
% Select last 30 data

mpfn.q = mpfn.q(:,end-29:end);
mpfn.smat = mpfn.smat(:,end-29:end);
mpfn.dsmat = zeros(size(mpfn.smat));
mpfn.vmat = mpfn.vmat(:,end-29:end);
mpfn.thetamat = mpfn.thetamat(:,end-29:end);
% Fine identification SETTINGS

MAXITER = 25;             % maximum iteration time
varsigma = 0.01;          % decide whether to remove branches
xi = 0.05;                % threshold to remove branches
varphi = 1*10^-10;        % decide whether to end iterations
% Constants

[n,~] = size(mpfn.bus);
[m,~] = size(mpfn.branch);
[~,M] = size(mpfn.smat);
% Initialization

deltapqlist = deltaPQ(mpfn);
dftp = norm(deltapqlist,2);   % throshold
% Error evaluation when starts

[gberror,wrong_add,wrong_miss] = errorevaluate(mpfn,qlist(1));
gberror = gberror*100;  % display in 100%
fprintf('[fine identification] Starts with error %e\n',dftp);
fprintf('MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n',gberror(1),gberror(2),length(wrong_add),length(wrong_miss));
% Start iteration

for T = 1:MAXITER
% Pseudo-Power Flow Calculation

    mpfn = pseudopf(mpfn);
% Jacobian matrix
% || A B C ||
% 
% || D E F ||

    Jmat = Jacobianmat(mpfn);
% Generalized reverse

    invJmat = pinv(Jmat);   
    % Delta S = Delta P,Q
    deltapqlist = deltaPQ(mpfn);
    % delta g,b,theta
    deltagbt = invJmat*deltapqlist;
    % renew g,b and theta
    mpfn = renewgbt(mpfn,deltagbt);
% Calculate throshold

    deltapqlist = deltaPQ(mpfn);
    df = norm(deltapqlist,2);   % throshold
% remove wrong branches

    if abs(df - dftp)<varsigma
        mpfn = removebran(mpfn,xi);
    end
% calculate throshold

    deltapqlist = deltaPQ(mpfn);
    df = norm(deltapqlist,2);   % throshold
% Error evaluation

    [gberror,wrong_add,wrong_miss] = errorevaluate(mpfn,qlist(1));
    gberror = gberror*100;  % display in 100%
% Decide whether to end iteration

    if abs(df - dftp)<varphi && T~=1
        fprintf('[fine identification] Ends with %d iterations, with error %e\n',T,df);
        fprintf('MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n',gberror(1),gberror(2),length(wrong_add),length(wrong_miss));
        break;
    else
        fprintf('[fine identification] No.%d ends with error %e\n',T,df);
        fprintf('MAPE: g: %f%%, b: %f%%; Wrong branch +/-: %d,%d\n',gberror(1),gberror(2),length(wrong_add),length(wrong_miss));
    end
    dftp = df;  
end
toc;
fprintf('[Identification] Pragramme successfully ends .........\n')
##### SOURCE END #####
--></body></html>